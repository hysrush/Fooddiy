<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.bit.dao.SnsDAO">



	<resultMap type ="snsVO" id="Map_SnsVO">
  		<result column = "sns_no" property ="no"/>
  		<result column = "sns_title" property = "title"/>
  		<result column = "sns_content" property ="content"/>
  		<result column = "sns_fileName" property ="fileName"/>
  		<result column = "sns_like" property ="like"/>
  		<result column = "reg_at" property ="regDate"/>
  		<result column = "view_cnt" property ="viewCnt"/>
  	</resultMap>
  	
  	
  	
 	<!--  sns게시판 리스트  -->
 	<select id="selectSns" parameterType ="pagingVO" resultMap="Map_SnsVO">
 		SELECT *
			FROM( SELECT ROWNUM RNUM, P.*
			FROM( SELECT SNS_NO, SNS_TITLE, SNS_CONTENT, SNS_FILENAME, SNS_LIKE,
					TO_CHAR(REG_AT, 'YY-MM-DD') as REG_AT, VIEW_CNT
			FROM T_SNS 
			ORDER BY SNS_NO DESC) P )
			WHERE RNUM BETWEEN #{start} AND #{last} 
 	</select>
  	
  		<!--  페이징 total 쿼리 -->
	<select id ="selectTotalPaging" resultType ="java.lang.Integer">
		SELECT COUNT(*)
		FROM T_SNS
	</select>
	
	<!-- 새글 등록  -->
	<insert id="insertSNS" parameterType="snsVO">
		
		INSERT INTO T_SNS( SNS_NO, SNS_TITLE, SNS_CONTENT, SNS_FILENAME)
					VALUES(SEQ_T_SNS_NO.NEXTVAL, #{title}, #{content},#{fileName})
	</insert>
	<!--  글번호로 디테일 보기  -->
		<select id="selectByNo" parameterType="int" resultMap="Map_SnsVO" >
		SELECT SNS_NO, SNS_TITLE, SNS_CONTENT, SNS_FILENAME, SNS_LIKE,
						TO_CHAR(REG_AT, 'YY-MM-DD')AS REG_AT, VIEW_CNT
		FROM T_SNS
		WHERE SNS_NO = #{no}
	</select>


  	
  <!-- 		 Notice 조회수 증가 
	<update id="updateViewcntNotice" parameterType="int">
        UPDATE t_SNS
        SET view_cnt = view_cnt + 1
        WHERE notice_no = #{no}
    </update> -->
  	
  	
</mapper> 	